const fs=require("fs"),path=require("path"),_={};_.D$={},_.M$={},_.$={};const logError=(e,r="error",t="")=>{let o=new Date().toISOString(),n=`[${o}] [${r.toUpperCase()}] ${e}`;t?console.log(`${n}`):console.log(n)};_.register=(e,r)=>{r&&"function"==typeof r.render?_.$[e]=r:logError(`Failed to register component: ${e} (Invalid or missing render function)`,"error")},_.autoloadComponents=e=>{let r=path.join(__dirname,e);if(!fs.existsSync(r)){logError("Components directory not found.","error",`Folder: ${r}`);return}fs.readdirSync(r).forEach(r=>{r.endsWith(".js")&&_.require().file(`${e}/${r}`)})},_.require=()=>({file(e){let r=path.resolve(__dirname,e);if(!fs.existsSync(r))return logError(`Component file not found: ${e}`,"error"),null;try{let t=require(r),o=path.basename(e,".js");return _.register(o,t),t}catch(n){return logError(`Error loading component ${e}: ${n.message}`,"error"),null}}}),_.renderComponent=(e,r={},t=0)=>{if(!_.$[e]){let o=_.require().file(`${e}.js`);console.log(e,o),o&&_.register(e,o)}return _.$[e]&&"function"==typeof _.$[e].render?t>50?(logError(`Infinite recursion detected in component: ${e}`,"error"),""):r&&"object"==typeof r?_.$[e].render(r,e=>e&&_.$[e]?_.renderComponent(e,r,t+1):_.$[e]||{}):_.$[e]:(logError(`Component "${e}" is missing or does not have a valid render() function.`,"error"),_.$[e]||{})},_.render=e=>_.el("html",'lang="en"',[_.el("head","",[e.header]),_.el("body","",[e.content])]),_.el=(e,r="",t=[],o={})=>{try{if("string"!=typeof e)return console.error(`Tag must be a string. Given: ${e}`),"";"string"!=typeof r&&(Array.isArray(r)?(t=r,r=""):(console.error(`Attributes must be a string. Given: ${r}`),r="")),Array.isArray(t)||(t=[t]),t=t.map(e=>"function"==typeof e?e():Array.isArray(e)?_.elment(e):e).join("");let n=o&&"object"==typeof o?Object.keys(o).map(e=>{let r=o[e];return`on${e}="${Array.isArray(r)?r.map(e=>e.replace(/"/g,"'")).join(";"):r.replace(/"/g,"'")}"`}).join(" "):"",i=[r,n].map(e=>e.trim()).filter(e=>""!==e).join(" "),l=["img","input","br","meta","link","hr"];if(l.includes(e.toLowerCase()))return`<${e} ${i} />`;return`<${e} ${i}>${t}</${e}>`}catch(a){return console.error(`Error in _.el(): ${a.message}`),`<${e}></${e}>`}};const elements=["div","span","p","h1","h2","h3","h4","h5","h6","ul","ol","li","a","img","button","input","form","label","section","article","header","footer","nav","aside","main","strong","em","b","i","table","tr","td","th","script","body","html","meta","title","link","head","br","main","small","hr","pre","code"];_.createEl=e=>{e.forEach(e=>{_[e]=(r="",t=[],o={})=>(Array.isArray(t)||(t=[t]),_.el(e,r,t,o))})},_.addEl=e=>{e.forEach(e=>{_[e.tag]=(r="",t=[],o={})=>(Array.isArray(t)||(t=[t]),_.el(tag,e.attr,e.children,e.events))})},_.createEl(elements),_.elment=e=>e.map(e=>"function"==typeof e?e():e).join(""),_.helpers=(e,r)=>{_.h[e]=r},_.if=(e,r,t="")=>e?r:t,_.switch=(e,r)=>r[e]?r[e]:(r.default||logError(`Switch case for "${e}" not found and no default case provided.`,"warning"),r.default||""),_.where=(e,r)=>"function"==typeof r?e.filter(r):"object"==typeof r?e.filter(e=>Object.keys(r).every(t=>e[t]===r[t])):[],_.for=(e,r,t)=>{if(Array.isArray(e))return e.map((e,t)=>r(e,t)).join("");if("object"==typeof e){let o=0;return Object.keys(e).map(t=>r(e[t],t,o++))}return"number"==typeof e&&"number"==typeof t?Array.from({length:t-e},(t,o)=>r(e+o,o)):"string"==typeof e?e:e===_.$?Object.keys(_.$).map((e,t)=>r(_.$[e],e,t)):[]},module.exports=_;